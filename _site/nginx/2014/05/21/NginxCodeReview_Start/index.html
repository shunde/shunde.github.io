
<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Nginx源码研究之开篇 (未完待更...)</title>
	<meta name="author" content="德少" />
    <link rel="start" href="/" />
	
	
	
	
    <script src="/assets/themes/full-twocol/js/jquery-1.7-latest.js"></script>
    <link rel="stylesheet" href="/assets/themes/full-twocol/css/basic.css" />
    <link rel="stylesheet" href="/assets/themes/full-twocol/css/main.css" />
</head>
<body >
<div id="sidebar">
	<h1><a href="/" title="德少的Blog">德少的Blog</a></h1>
	<div id="description">stay foolish, stay hungry!</div>
	<ul id="nav">
		<li>
			<form action="./search.htm" method="get">
				<input type="text" name="q" class="search" onblur="if (this.value == &#39;&#39;) {this.value = &#39;搜索&#39;;}" onfocus="if (this.value == &#39;搜索&#39;) {this.value = &#39;&#39;;}" value="搜索">
			</form>
		</li>
		<li><a href="/archive.html">存档</a></li>
		<li><a href="/categories.html">分类</a></li>
		<li><a href="/about.html">关于</a></li>
	</ul>
	
</div>
<div id="main">

<ul id="post-list">
            
			<span class="date" style="position: absolute; top: auto; bottom: auto;">
                  <span class="month">May</span>
                  <span class="day">21</span>
               </span>
            
	<!--text-->
		<li class="post text">
			<div class="body">
				
				<h1 class="emphnext">Nginx源码研究之开篇 (未完待更...)</h1>


  <p>先看下Nginx源码的目录结构：</p>

<pre><code>/home/shunde/nginx-1.6.0/
├── auto              自动检测系统环境以及编译相关的脚本
│   ├── cc            关于编译相关的编译选项的检测脚本
│   ├── lib           nginx 编译所需要的一些库的检测脚本
│   ├── os            与平台相关的一些系统参数与系统调用相关的检测
│   └── types         与数据类型相关的一些辅助脚本
├── conf              存放默认配置文件，在make install后，会拷贝到安装目录中去
├── contrib           存放一些适用工具，如geo配置生成工具（geo2nginx.pl）
├── html              存放默认的网页文件，在make install后，会拷贝到安装目录中去
├── man               nginx的man手册
└── src               存放nginx的源代码
    ├── core          nginx的核心源代码，包括常用数据结构的定义，以及nginx初始化运行的核心代码如main函数
    ├── event         对系统事件处理机制的封装，以及定时器的实现相关代码
    │   └── modules   不同事件处理方式的模块化，如select、poll、epoll、kqueue等
    ├── http          nginx作为http服务器相关的代码
    │   └── modules   包含http的各种功能模块
    ├── mail          nginx作为邮件代理服务器相关的代码
    ├── misc          一些辅助代码，测试c++头的兼容性，以及对google_perftools的支持
    └── os            主要是对各种不同体系统结构所提供的系统函数的封装，对外提供统一的系统调用接口
</code></pre>

<p>我们来进入main函数窥探下nginx的启动：</p>

<ul>
  <li>调用<code>ngx_debug_init()</code> debug初始化</li>
  <li>调用<code>ngx_get_options()</code>解析命令参数</li>
  <li>调用<code>ngx_time_init()</code>初始化并更新时间</li>
  <li>调用<code>ngx_regex_init()</code></li>
</ul>


  <!-- JiaThis Button BEGIN -->
<div id="ckepop">
<span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_qzone">QQ空间</a>
<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" src="http://v2.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->
  <BR/>
  <div class="prev-next">
  
    <a href="/%E9%9A%8F%E7%AC%94/2014/06/07/how_prejudice_destroy_a_programmer" class="next" title="偏见是如何毁掉一个程序员的？">向右走 &rarr;</a>
  
  
    <a href="/%E9%9A%8F%E7%AC%94/2014/05/03/say-hello" class="prev" title="Say hello">&larr; 向左走</a>
  
  </div>
			</div>
			<div class="meta">
					<span class="tags">
						
				
				
				
				
				
				
					</span>
				
			</div>
		</li>
</ul>






  <!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"joshualeung"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->





</div>
</body></html>
